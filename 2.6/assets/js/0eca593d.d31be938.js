"use strict";(self.webpackChunknew_noodl_docs=self.webpackChunknew_noodl_docs||[]).push([[4505],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),m=i,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||o;return n?a.createElement(h,r(r({ref:t},p),{},{components:n})):a.createElement(h,r({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var c=2;c<o;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},53488:function(e,t,n){n.d(t,{Z:function(){return o}});var a=n(67294);function i(e){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){console.log("Async: Copying to clipboard was successful!")}),(function(e){console.error("Async: Could not copy text: ",e)})):function(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var n=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+n)}catch(a){console.error("Fallback: Oops, unable to copy",a)}document.body.removeChild(t)}(e)}function o(e){return a.createElement("button",{className:"ndl-copy-nodes-button",onClick:function(){return t=e.json,void i(JSON.stringify(t));var t}})}},34119:function(e,t,n){n.r(t),n.d(t,{assets:function(){return d},contentTitle:function(){return c},default:function(){return h},frontMatter:function(){return s},metadata:function(){return p},toc:function(){return u}});var a=n(83117),i=n(80102),o=(n(67294),n(3905)),r=n(53488),l=["components"],s={},c="Client Side Business Logic Using Javascript",p={unversionedId:"guides/business-logic/client-side-biz-logic-js",id:"guides/business-logic/client-side-biz-logic-js",title:"Client Side Business Logic Using Javascript",description:"What you will learn in this guide",source:"@site/docs/guides/business-logic/client-side-biz-logic-js.mdx",sourceDirName:"guides/business-logic",slug:"/guides/business-logic/client-side-biz-logic-js",permalink:"/2.6/docs/guides/business-logic/client-side-biz-logic-js",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Client Side Business Logic Using Nodes",permalink:"/2.6/docs/guides/business-logic/client-side-biz-logic-nodes"},next:{title:"Custom UI Components",permalink:"/2.6/docs/guides/business-logic/custom-ui-components"}},d={},u=[{value:"What you will learn in this guide",id:"what-you-will-learn-in-this-guide",level:2},{value:"Overview",id:"overview",level:2},{value:"Creating a list with multiselect UI",id:"creating-a-list-with-multiselect-ui",level:2},{value:"The base data",id:"the-base-data",level:2},{value:"Building a Multi Select List",id:"building-a-multi-select-list",level:2},{value:"Selection logic",id:"selection-logic",level:3},{value:"Setter functions - execute code when an input changes",id:"setter-functions---execute-code-when-an-input-changes",level:2},{value:"Using a Component Object in your scripts",id:"using-a-component-object-in-your-scripts",level:2},{value:"Making the List Items",id:"making-the-list-items",level:2},{value:"Triggering Signals in a Script",id:"triggering-signals-in-a-script",level:2},{value:"Timing of signals",id:"timing-of-signals",level:2},{value:"Sending signals from a script",id:"sending-signals-from-a-script",level:2},{value:"Finishing off the Multi Select List",id:"finishing-off-the-multi-select-list",level:2}],m={toc:u};function h(e){var t=e.components,s=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,a.Z)({},m,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"client-side-business-logic-using-javascript"},"Client Side Business Logic Using Javascript"),(0,o.kt)("h2",{id:"what-you-will-learn-in-this-guide"},"What you will learn in this guide"),(0,o.kt)("p",null,"This guide shows how you use Javascript to implement business logic on the client (front-end) side of your app. While you can build business logic with a no-code approach using logic nodes (as described in ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/business-logic/client-side-biz-logic-nodes"},"this guide"),") its often easier to use Javascript since business logic sometimes is more readable in code form. In this guide we will  make use of the ",(0,o.kt)("a",{parentName:"p",href:"/nodes/javascript/function"},"Function")," and ",(0,o.kt)("a",{parentName:"p",href:"/nodes/javascript/script"},"Script")," nodse which are the main way to mix code and no-code in Noodl.\nAnother important node is the ",(0,o.kt)("a",{parentName:"p",href:"/nodes/component-utilities/component-object"},"Component Object")," that's the main way of storing state data so it can be accessed easily both in the code world and the node world."),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"The guide will implement a simple multiselect interaction on a list and a few multiselect operations, such as delete and copy. The business logic will handle the multi-select itself (selecting, deselecting) as well as the operations on the content in the list. It will also control the state of ",(0,o.kt)("strong",{parentName:"p"},"Buttons")," on the screen."),(0,o.kt)("p",null,"We will use various Noodl concepts, such as lists, Arrays and Objects, so it's probably good if you have gone through those guides before ( ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/data/list-basics"},"List guide"),", ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/data/arrays"},"Array guide")," and ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/data/objects"},"Object guide"),"). We will also use Javascript of course, and especially many Array functions, so that's worth checking out as well. A good documentation can be found for example ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array"},"here"),". "),(0,o.kt)("h2",{id:"creating-a-list-with-multiselect-ui"},"Creating a list with multiselect UI"),(0,o.kt)("p",null,"This example will revolve around a simple collection of orders, for example in a e-commerce system. The orders have an ",(0,o.kt)("inlineCode",{parentName:"p"},"order_nbr"),", a ",(0,o.kt)("inlineCode",{parentName:"p"},"quantity")," and a ",(0,o.kt)("inlineCode",{parentName:"p"},"delivery_date"),". The App should list the orders and let the user select a number of them, using a standard multi select interaction. Then the selected orders can either be ",(0,o.kt)("em",{parentName:"p"},"deleted"),", ",(0,o.kt)("em",{parentName:"p"},"copied")," or ",(0,o.kt)("em",{parentName:"p"},"merged"),". We will look what the actual operations mean in more detail as we implement them. It's also possible to ",(0,o.kt)("em",{parentName:"p"},"select all")," or ",(0,o.kt)("em",{parentName:"p"},"deselect all")," items."),(0,o.kt)("h2",{id:"the-base-data"},"The base data"),(0,o.kt)("p",null,"We start this guide by adding in our base dataset that we want to work on. We are going to use the ",(0,o.kt)("a",{parentName:"p",href:"/nodes/data/array/static-array"},"Static Array"),' to keep our data, but in essence this data could have come from a cloud database. So start a new project, using the "Hello World" template. Then add a ',(0,o.kt)("strong",{parentName:"p"},"Static Array")," node, set it to ",(0,o.kt)("inlineCode",{parentName:"p"},"JSON")," format, and add in the following data:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'[   \n    {"order_nbr":"A-12124", "quantity":2, "delivery_date":"2022-10-23"},\n    {"order_nbr":"A-26232", "quantity":6, "delivery_date":"2022-10-25"},\n    {"order_nbr":"V-23532", "quantity":3, "delivery_date":"2022-09-13"},\n    {"order_nbr":"B-99243", "quantity":5, "delivery_date":"2022-08-03"},\n    {"order_nbr":"V-35124", "quantity":1, "delivery_date":"2022-12-20"},\n    {"order_nbr":"G-23421", "quantity":1, "delivery_date":"2022-09-09"},\n    {"order_nbr":"B-86612", "quantity":8, "delivery_date":"2022-11-21"},\n    {"order_nbr":"C-61633", "quantity":5, "delivery_date":"2022-05-29"},\n    {"order_nbr":"V-42241", "quantity":2, "delivery_date":"2022-11-15"},\n    {"order_nbr":"V-99112", "quantity":12, "delivery_date":"2022-12-20"},\n    {"order_nbr":"A-51512", "quantity":1, "delivery_date":"2022-07-07"},\n    {"order_nbr":"B-00914", "quantity":8, "delivery_date":"2022-09-13"},\n    {"order_nbr":"C-11121", "quantity":9, "delivery_date":"2022-10-19"}\n]\n')),(0,o.kt)("p",null,"Now we have some orders in the system so ket's start building the UI. We will start with the multi select list."),(0,o.kt)("h2",{id:"building-a-multi-select-list"},"Building a Multi Select List"),(0,o.kt)("p",null,"We want to build a component that can show an array of items, as well as keeping track of which items that are selected. Let's outline the functionality of it below"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"You should be able to feed it with items that will be shown in the list, with a checkbox in front of them"),(0,o.kt)("li",{parentName:"ul"},"You should be able to feed it an initial selection, i.e. which items that should be selected"),(0,o.kt)("li",{parentName:"ul"},"As you selected or deselect items, the component should trigger a signal and also provide an ",(0,o.kt)("strong",{parentName:"li"},"Array")," with the items that are currently selected"),(0,o.kt)("li",{parentName:"ul"},"You should be able to select or deselect all items by triggering a signal")),(0,o.kt)("p",null,"A question is how the multi select list would encode which items that are selected. One way of doing it would be that the multiselect list would provide an ",(0,o.kt)("strong",{parentName:"p"},"Array")," of items of format:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Value":<id of selected object>\n}\n')),(0,o.kt)("p",null,'So for example, if the list has three items, with ids "111", "222" and "333". If the first and second item are selected, the output from the component would be:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {\n        "Value":"111"\n    },\n    {\n        "Value":"222"\n    }\n]\n')),(0,o.kt)("p",null,"So, when we are done, the component would look something like below from the outside:"),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(231).Z,width:"650",height:"402"}))),(0,o.kt)("h3",{id:"selection-logic"},"Selection logic"),(0,o.kt)("p",null,"Let's think about the logic needed by the component. Internally the component would need to keep track of which items that are selected and which are not. Partly to be able to generate the ",(0,o.kt)("strong",{parentName:"p"},"Array")," above, but also to be able to visualize it correctly."),(0,o.kt)("p",null,"You could of course store the selection state directly in the item, i.e. an order in our case, but that's actually not a great design. What would happen if the order was part of multiple Multi Select lists? Also, if we end up storing the item in the database we might also store the selection state if we are not careful, which doesn't make sense at all."),(0,o.kt)("p",null,'A better design is to "wrap" the each order in another ',(0,o.kt)("strong",{parentName:"p"},"Object"),' that keeps track of the selection state. Then we display a list of those objects when we present the list instead of the original items. The "wrapper" of course needs to store the ',(0,o.kt)("strong",{parentName:"p"},"Id")," of the ",(0,o.kt)("strong",{parentName:"p"},"Object")," that it wraps so it can present the data from the item too. The format of the wrapper could be:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {\n        "Checked":<true or false depending if the item is checked or not>,\n        "Value":<the id of the Object it wraps>\n    }\n]\n')),(0,o.kt)("p",null,'So, again in the example above with the items with id "111", "222" and "333", with the first two checked, the Checkbox array would look like the following:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {\n        "Checked":true,\n        "Value":"111"\n    },\n    {\n        "Checked":true,\n        "Value":"222"\n    },\n    {\n        "Checked":false,\n        "Value":"333"\n    },\n]\n')),(0,o.kt)("p",null,"So in summary our Multi Select list component will need the following logic on the inside"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"When the list is fed with new items, it will create one new Checkbox Array containing an ",(0,o.kt)("strong",{parentName:"li"},"Object")," per item (the wrapper) and set ",(0,o.kt)("inlineCode",{parentName:"li"},"Checked")," to ",(0,o.kt)("inlineCode",{parentName:"li"},"true")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"false")," depending on initial selection."),(0,o.kt)("li",{parentName:"ul"},"The list item presenting each item will use the ",(0,o.kt)("inlineCode",{parentName:"li"},"Checked")," property to visualize the checked status of the item. If the user clicks the checkbox the ",(0,o.kt)("inlineCode",{parentName:"li"},"Checked")," property is toggled."),(0,o.kt)("li",{parentName:"ul"},"Whenever the checked status changes, the Multi Select List should generete a new list that only holds the items that are checked, according to the format above, i.e. ",(0,o.kt)("inlineCode",{parentName:"li"},'[{"Value":<id of a checked item>}, ...]'),". This will be presented to the outside world.")),(0,o.kt)("p",null,'Start by creating a new visual component. Call it "Multi Select List".'),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(9543).Z,width:"885",height:"780"}))),(0,o.kt)("p",null,"You will now have a more or less empty component. Add in a ",(0,o.kt)("strong",{parentName:"p"},"Component Inputs")," and a ",(0,o.kt)("strong",{parentName:"p"},"Component Outputs"),". We now what they should contain are already, i.e. how to interact with our component. So in the ",(0,o.kt)("strong",{parentName:"p"},"Component Inputs")," add the ports ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Items"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"Select All")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Clear Selection"),"."),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(96126).Z,width:"717",height:"472"}))),(0,o.kt)("p",null,"In the ",(0,o.kt)("strong",{parentName:"p"},"Component Outputs")," we create the ports ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection Changed"),". "),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(72523).Z,width:"720",height:"282"}))),(0,o.kt)("p",null,"Now we begin writing our Javascript logic. Add a ",(0,o.kt)("strong",{parentName:"p"},"Script")," node. "),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(49494).Z,width:"1522",height:"700"}))),(0,o.kt)("p",null,"We begin by adding two inputs, one is the ",(0,o.kt)("inlineCode",{parentName:"p"},"Items")," that the list should display. The other is the ",(0,o.kt)("inlineCode",{parentName:"p"},"InitialSelection")," that contains any items that should be selected initially by the list. Both of these are of ",(0,o.kt)("inlineCode",{parentName:"p"},"Array")," type."),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(26399).Z,width:"687",height:"960"}))),(0,o.kt)("p",null,"Ok, let's start coding! The first thing we want to do is to generate our Checkbox list, i.e. the ",(0,o.kt)("strong",{parentName:"p"},"Array")," of wrapping ",(0,o.kt)("strong",{parentName:"p"},"Objects")," that hold the checked state of each item."),(0,o.kt)("h2",{id:"setter-functions---execute-code-when-an-input-changes"},"Setter functions - execute code when an input changes"),(0,o.kt)("p",null,"We want to generate that ",(0,o.kt)("strong",{parentName:"p"},"Array")," any time the ",(0,o.kt)("inlineCode",{parentName:"p"},"Items")," input changes. If you want to execute a piece of script any time a specific input changes you can use a ",(0,o.kt)("em",{parentName:"p"},"Setter")," function. These are declared using the following format:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Script.Setters.<property name> = function (value) {...}\n")),(0,o.kt)("p",null,"In our case we want to generate the Checkbox ",(0,o.kt)("strong",{parentName:"p"},"Array")," whenever ",(0,o.kt)("strong",{parentName:"p"},"Items")," is changed so we add the follwing code in our script file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Script.Setters.Items = function (items) {\n    if(!Script.Inputs.Items) return \n    // Create a list of all items with checked status, based on the initial selection array\n    Component.Object.Checkboxes = Script.Inputs.Items.map(o => Noodl.Object.create({\n        id:Component.Object.id+'-'+o.id,\n        Value:o.id,\n        Checked:Script.Inputs.InitialSelection!==undefined && !!Script.Inputs.InitialSelection.find(s => s.Value === o.id)\n    })) \n}\n")),(0,o.kt)("p",null,"This code goes through the incoming ",(0,o.kt)("strong",{parentName:"p"},"Items")," (referred to through ",(0,o.kt)("inlineCode",{parentName:"p"},"Script.Inputs.Items"),"), and for each item creates a new wrapper ",(0,o.kt)("strong",{parentName:"p"},"Object")," (using ",(0,o.kt)("inlineCode",{parentName:"p"},"Noodl.Object.create"),"). It checks the checked state and sets either ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"false")," against the initial selection array. It also stores a pointer to the wrapped ",(0,o.kt)("strong",{parentName:"p"},"Object")," in the property ",(0,o.kt)("inlineCode",{parentName:"p"},"Value"),"."),(0,o.kt)("p",null,"Another little trick here is that we explicitly set the ",(0,o.kt)("strong",{parentName:"p"},"id")," of the wrapper ",(0,o.kt)("strong",{parentName:"p"},"Object"),". This is actually not needed, as Noodl will generate a new ",(0,o.kt)("strong",{parentName:"p"},"id")," if no ",(0,o.kt)("strong",{parentName:"p"},"id")," is specified. But by making up an ",(0,o.kt)("strong",{parentName:"p"},"id")," of our own, that will be unique but the same for every wrapper object that wraps a specific object, we will reuse old ",(0,o.kt)("strong",{parentName:"p"},"Objects")," rather than creating new."),(0,o.kt)("p",null,"As you can see, the resulting ",(0,o.kt)("strong",{parentName:"p"},"Array")," is stored in ",(0,o.kt)("inlineCode",{parentName:"p"},"Component.Object.Checkboxes"),". This we should pay some extra attention to."),(0,o.kt)("h2",{id:"using-a-component-object-in-your-scripts"},"Using a Component Object in your scripts"),(0,o.kt)("p",null,"Each component in Noodl have a ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," that's unique. Opposite to a regular ",(0,o.kt)("strong",{parentName:"p"},"Object")," a ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," ",(0,o.kt)("em",{parentName:"p"},"can only be accessed by the component itself, or by children of the component using ",(0,o.kt)("strong",{parentName:"em"},"Parent Component Objects")),". This creates a scope and you does not risk other components accessing this object by mistake. For example if you would show two Multi Select lists on the same screen, if you used a regular ",(0,o.kt)("strong",{parentName:"p"},"Object")," to store your Checkboxes, you would need to make sure the ",(0,o.kt)("strong",{parentName:"p"},"Objects")," had unique ids (the Checkboxes can be different in the two lists). We avoid this problem all togheter by storing our Checkboxes in our ",(0,o.kt)("strong",{parentName:"p"},"Component Object"),"."),(0,o.kt)("p",null,"All components have a Component Object, and you can access it in the Node world by adding a ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," node. So close the ",(0,o.kt)("strong",{parentName:"p"},"Script")," node for now, and add in a ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," node. Also add the property ",(0,o.kt)("strong",{parentName:"p"},"Checkboxes")," on the ",(0,o.kt)("strong",{parentName:"p"},"Component Object"),"."),(0,o.kt)("p",null,"While we are at it we also connect the two outputs from ",(0,o.kt)("strong",{parentName:"p"},"Component Inputs")," (",(0,o.kt)("inlineCode",{parentName:"p"},"Items")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection"),") to ",(0,o.kt)("strong",{parentName:"p"},"Items")," and ",(0,o.kt)("strong",{parentName:"p"},"Initial Selection")," inputs on the ",(0,o.kt)("strong",{parentName:"p"},"Script")," node."),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(50541).Z,width:"1530",height:"635"}))),(0,o.kt)("p",null,"Let's test what we done so far, so we add in an ",(0,o.kt)("strong",{parentName:"p"},"Array")," node and connect the ",(0,o.kt)("strong",{parentName:"p"},"Checkboxes")," property of the ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," to it (through the ",(0,o.kt)("strong",{parentName:"p"},"Items")," property). Next, we add in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List")," component into our main App. Give it some items by connecting the ",(0,o.kt)("strong",{parentName:"p"},"Static Array")," items to it. If all is set up correctly, you should see some Checkbox items flowing into the ",(0,o.kt)("strong",{parentName:"p"},"Array"),"."),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(39494).Z,width:"2315",height:"997"}))),(0,o.kt)("h2",{id:"making-the-list-items"},"Making the List Items"),(0,o.kt)("p",null,"Now we are ready to create the List Items. Let's package up our ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List")," components into a folder. So create a new folder, call it ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List"),". Move our ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List")," component into it. Then add another visual component. Call it ",(0,o.kt)("inlineCode",{parentName:"p"},"List Item"),"."),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(68150).Z,width:"677",height:"372"}))),(0,o.kt)("p",null,"We keep the list item visually simple. A horizontal layout with a ",(0,o.kt)("a",{parentName:"p",href:"/nodes/ui-controls/checkbox"},"Checkbox")," and three texts. Add some padding and margins to make it a little prettier. If you want, you can copy and paste the nodes into your component."),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)(r.Z,{json:{nodes:[{id:"5c3f112c-604f-5c89-f500-bf8c79701ebc",type:"Group",x:-106,y:-21,parameters:{flexDirection:"row",paddingTop:{value:10,unit:"px"},paddingBottom:{value:10,unit:"px"},paddingLeft:{value:10,unit:"px"},paddingRight:{value:10,unit:"px"},sizeMode:"contentHeight"},ports:[],children:[{id:"8bfcaedb-94c0-e145-f973-5627c4adc2c8",type:"net.noodl.controls.checkbox",x:-86,y:25,parameters:{useLabel:!1,marginRight:{value:9,unit:"px"}},ports:[],children:[]},{id:"4abf508d-30fd-8273-0b5c-1c43ffc761fb",type:"Text",label:"Order nr",x:-86,y:71,parameters:{},ports:[],children:[]},{id:"66a0a3b1-f67c-37fe-26ab-47df859823e7",type:"Text",label:"Quantity",x:-86,y:131,parameters:{},ports:[],children:[]},{id:"80e557b6-964a-a9bb-87d4-13b4bf7ee1d5",type:"Text",label:"Delivery date",x:-86,y:191,parameters:{},ports:[],children:[]}]}],connections:[],comments:[]},mdxType:"CopyToClipboardButton"}),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(2983).Z,width:"900",height:"1385"}))),(0,o.kt)("p",null,"Then we hook up the data. We need to keep two ",(0,o.kt)("strong",{parentName:"p"},"Objects")," in mind this time. We have the ",(0,o.kt)("strong",{parentName:"p"},"Object")," providede by the ",(0,o.kt)("strong",{parentName:"p"},"Repeater"),' - the "wrapper", and the actual order. We hook it up like below. We also add a ',(0,o.kt)("strong",{parentName:"p"},"Component Output")," to we can know if a Checkbox was clicked."),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)(r.Z,{json:{nodes:[{id:"176161a9-4c47-55e4-411e-73235b45899a",type:"Group",x:-106,y:-21,parameters:{flexDirection:"row",paddingTop:{value:10,unit:"px"},paddingBottom:{value:10,unit:"px"},paddingLeft:{value:10,unit:"px"},paddingRight:{value:10,unit:"px"},sizeMode:"contentHeight"},ports:[],children:[{id:"383c1752-5771-22f5-1334-160bdc0a7d99",type:"net.noodl.controls.checkbox",x:-86,y:25,parameters:{useLabel:!1,marginRight:{value:9,unit:"px"}},ports:[],children:[]},{id:"484c1964-a75f-c9f2-cdb9-2544a4b215d7",type:"Text",label:"Order nr",x:-86,y:127,parameters:{},ports:[],children:[]},{id:"cbe0804c-f3d2-e3bc-8773-ed005e88d4f8",type:"Text",label:"Quantity",x:-86,y:223,parameters:{},ports:[],children:[]},{id:"68fdebf1-67ee-702f-23cb-21d5b240f3a2",type:"Text",label:"Delivery date",x:-86,y:319,parameters:{},ports:[],children:[]}]},{id:"739ecad6-ec0f-9f2b-aeaa-4bae353e7570",type:"Model2",label:"Wrapper",x:-583.3416811729484,y:163.33900090176894,parameters:{idSource:"foreach",properties:"Checked,Value"},ports:[],children:[]},{id:"5e697dd5-760b-b449-dcbd-1bd2629cc786",type:"Component Outputs",x:455.8443558682088,y:170.21729798352135,parameters:{},ports:[{name:"Selection Changed",plug:"input",type:{name:"*"},index:1}],children:[]},{id:"cdd8417c-4d43-2bbe-aaa9-e23a22c8fb04",type:"SetModelProperties",x:208.84435586820882,y:169.21729798352135,parameters:{properties:"Checked"},ports:[],children:[]},{id:"0b1e1592-c722-9af7-9903-206b05af8cdd",type:"Model2",label:"Order",x:-321.1860370411575,y:104.12170291824759,parameters:{properties:"order_nbr,quantity,delivery_date"},ports:[],children:[]}],connections:[{fromId:"739ecad6-ec0f-9f2b-aeaa-4bae353e7570",fromProperty:"id",toId:"cdd8417c-4d43-2bbe-aaa9-e23a22c8fb04",toProperty:"modelId"},{fromId:"739ecad6-ec0f-9f2b-aeaa-4bae353e7570",fromProperty:"prop-Checked",toId:"383c1752-5771-22f5-1334-160bdc0a7d99",toProperty:"checked"},{fromId:"383c1752-5771-22f5-1334-160bdc0a7d99",fromProperty:"checked",toId:"cdd8417c-4d43-2bbe-aaa9-e23a22c8fb04",toProperty:"prop-Checked"},{fromId:"383c1752-5771-22f5-1334-160bdc0a7d99",fromProperty:"onChange",toId:"cdd8417c-4d43-2bbe-aaa9-e23a22c8fb04",toProperty:"store"},{fromId:"cdd8417c-4d43-2bbe-aaa9-e23a22c8fb04",fromProperty:"stored",toId:"5e697dd5-760b-b449-dcbd-1bd2629cc786",toProperty:"Selection Changed"},{fromId:"739ecad6-ec0f-9f2b-aeaa-4bae353e7570",fromProperty:"prop-Value",toId:"0b1e1592-c722-9af7-9903-206b05af8cdd",toProperty:"modelId"},{fromId:"0b1e1592-c722-9af7-9903-206b05af8cdd",fromProperty:"prop-order_nbr",toId:"484c1964-a75f-c9f2-cdb9-2544a4b215d7",toProperty:"text"},{fromId:"0b1e1592-c722-9af7-9903-206b05af8cdd",fromProperty:"prop-quantity",toId:"cbe0804c-f3d2-e3bc-8773-ed005e88d4f8",toProperty:"text"},{fromId:"0b1e1592-c722-9af7-9903-206b05af8cdd",fromProperty:"prop-delivery_date",toId:"68fdebf1-67ee-702f-23cb-21d5b240f3a2",toProperty:"text"}],comments:[]},mdxType:"CopyToClipboardButton"}),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(91458).Z,width:"2727",height:"1135"}))),(0,o.kt)("p",null,"We add in a ",(0,o.kt)("strong",{parentName:"p"},"Repeater")," node in our ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List")," component, pick our newly created list item as the item template. Finally we connect the ",(0,o.kt)("strong",{parentName:"p"},"Checkboxes")," output on our ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," to the ",(0,o.kt)("strong",{parentName:"p"},"Items")," input of the repeater. We have a list!"),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(39494).Z,width:"2315",height:"997"}))),(0,o.kt)("h2",{id:"triggering-signals-in-a-script"},"Triggering Signals in a Script"),(0,o.kt)("p",null,"Now it's time that we write the script that will generate our selection list, i.e. an ",(0,o.kt)("strong",{parentName:"p"},"Array")," that will contain all the items that are currently checked. As you may remember, we decided on this format:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "Value":<id of selected object>\n}\n')),(0,o.kt)("p",null,"We go back into our Multiselect Logic Script node and start by adding in a new function. Call it ",(0,o.kt)("inlineCode",{parentName:"p"},"updateSelection"),". It will look like below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'function updateSelection () {\n    Component.Object.Selection = Component.Object.Checkboxes.filter(o => o.Checked)\n    .map(o => Noodl.Object.create({\n            id:Component.Object.id+"_"+o.Value,\n            Value:o.Value}\n    ));\n}\n')),(0,o.kt)("p",null,"Again, we are using our ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," to store our ",(0,o.kt)("strong",{parentName:"p"},"Array"),". The ",(0,o.kt)("strong",{parentName:"p"},"Array")," is generated by walking through the Checkboxes ",(0,o.kt)("strong",{parentName:"p"},"Array")," and look for checked items. We then make a new ",(0,o.kt)("strong",{parentName:"p"},"Object")," (or recycling an old one if the ",(0,o.kt)("strong",{parentName:"p"},"id")," already exists) storing the ",(0,o.kt)("strong",{parentName:"p"},"id")," of the checked item in ",(0,o.kt)("strong",{parentName:"p"},"Value"),"."),(0,o.kt)("p",null,"We actually need to call this in our Setter function for ",(0,o.kt)("inlineCode",{parentName:"p"},"Items")," from before so right after we created the ",(0,o.kt)("strong",{parentName:"p"},"Checkboxes")," Array, so we immedieately get the Selection ",(0,o.kt)("strong",{parentName:"p"},"Array")," set up. So we update it like below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Script.Setters.Items = function (items) {\n    if(!Script.Inputs.Items) return \n    // Create a lits of all checked items, based on the initial selection array\n    Component.Object.Checkboxes = Script.Inputs.Items.map(o => Noodl.Object.create({\n        id:Component.Object.id+'-'+o.id,\n        Value:o.id,\n        Checked:Script.Inputs.InitialSelection!==undefined && !!Script.Inputs.InitialSelection.find(s => s.Value === o.id)\n    })) \n\n    updateSelection ();\n}\n")),(0,o.kt)("p",null,"We also need to be able to trigger the ",(0,o.kt)("inlineCode",{parentName:"p"},"updateSelection")," whenever a user clicks a checkbox, regenerating the list. We can add ",(0,o.kt)("strong",{parentName:"p"},"signals")," to our scripts by writing ",(0,o.kt)("inlineCode",{parentName:"p"},"Script.Signals.<Signal name>"),". These signals will become inputs on the ",(0,o.kt)("strong",{parentName:"p"},"Script")," node that we can trigger. So our signal be named ",(0,o.kt)("inlineCode",{parentName:"p"},"UpdateSelection")," and will look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Script.Signals.UpdateSelection = function () {\n    updateSelection ();\n}\n")),(0,o.kt)("p",null,"We can now connect the outgoing signal ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection Changed")," from our ",(0,o.kt)("strong",{parentName:"p"},"Repeater")," (which is triggered from the ",(0,o.kt)("strong",{parentName:"p"},"Checkbox")," in the list item) to this new signal. We also connect the ",(0,o.kt)("inlineCode",{parentName:"p"},"Selections")," ",(0,o.kt)("strong",{parentName:"p"},"Array")," in our ",(0,o.kt)("strong",{parentName:"p"},"Component Object")," to our ",(0,o.kt)("strong",{parentName:"p"},"Component Output")," in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List"),"."),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(14470).Z,width:"1835",height:"860"}))),(0,o.kt)("p",null,"Try clicking different Checkboxes and you should see the ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection")," ",(0,o.kt)("strong",{parentName:"p"},"Array")," change accordingly."),(0,o.kt)("h2",{id:"timing-of-signals"},"Timing of signals"),(0,o.kt)("p",null,"There is a timing aspect that's important to look into. Our ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List")," should send out an event whenever the selection changes, together with the new selection array. If we directly connect the ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection Changed")," signal from the ",(0,o.kt)("strong",{parentName:"p"},"Repeater")," node to the ",(0,o.kt)("strong",{parentName:"p"},"Component Output")," we cannot be certain that the ",(0,o.kt)("strong",{parentName:"p"},"Script")," node has executed once the signal is triggered. It may or may not be the case. So anyone listening to the ",(0,o.kt)("strong",{parentName:"p"},"Selection Changed")," signal of the ",(0,o.kt)("inlineCode",{parentName:"p"},"Multi Select List")," that also reads the new selection ( a very likely case) may read the previous ",(0,o.kt)("strong",{parentName:"p"},"Array"),"."),(0,o.kt)("p",null,"The solution is to chain these events. The ",(0,o.kt)("strong",{parentName:"p"},"Selection Changed")," event should trigger the ",(0,o.kt)("inlineCode",{parentName:"p"},"UpdateSelection")," signal on the ",(0,o.kt)("strong",{parentName:"p"},"Script")," node, then once the new selection ",(0,o.kt)("strong",{parentName:"p"},"Array")," is generated we need to send a signal from the ",(0,o.kt)("strong",{parentName:"p"},"Script")," that then will be used as the output signal from the component."),(0,o.kt)("h2",{id:"sending-signals-from-a-script"},"Sending signals from a script"),(0,o.kt)("p",null,"Let's add that signal. Click on the ",(0,o.kt)("strong",{parentName:"p"},"Script")," node. Then add a new output. Call it ",(0,o.kt)("inlineCode",{parentName:"p"},"SelectionChanged"),"."),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(79374).Z,width:"1050",height:"1002"}))),(0,o.kt)("p",null,"Then make sure it's set up as a ",(0,o.kt)("strong",{parentName:"p"},"Signal"),"."),(0,o.kt)("div",{className:"ndl-image-with-background"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(86393).Z,width:"710",height:"1167"}))),(0,o.kt)("p",null,"Now we can send the signal from within our ",(0,o.kt)("strong",{parentName:"p"},"Script")," by calling it as a function ",(0,o.kt)("inlineCode",{parentName:"p"},"Script.Outputs.<signal name> ()"),". In our case we add it in i our ",(0,o.kt)("inlineCode",{parentName:"p"},"updateSelection")," function, as below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'Component.Object.Selection = Component.Object.Checkboxes.filter(o => o.Checked)\n    .map(o => Noodl.Object.create({\n            id:Component.Object.id+"_"+o.Value,\n            Value:o.Value}\n    ));\n    Script.Outputs.SelectionChanged ();\n')),(0,o.kt)("p",null,"We can now connect our new output ",(0,o.kt)("inlineCode",{parentName:"p"},"SelectionChanged")," to the ",(0,o.kt)("inlineCode",{parentName:"p"},"Selection Changed")," input on the ",(0,o.kt)("strong",{parentName:"p"},"Component Outputs"),"."),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(14612).Z,width:"1850",height:"847"}))),(0,o.kt)("h2",{id:"finishing-off-the-multi-select-list"},"Finishing off the Multi Select List"),(0,o.kt)("p",null,"The only thing left now is to implement the Select all / Clear selection functionality. This will be very easily done. We add two more incoming signals in our ",(0,o.kt)("strong",{parentName:"p"},"Scrip")," node, ",(0,o.kt)("inlineCode",{parentName:"p"},"Script.Signals.SelectAll")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Script.Signals.DeselectAll"),"."),(0,o.kt)("p",null,"Adding implementing them in our ",(0,o.kt)("strong",{parentName:"p"},"Script")," node is easy and the full code now looks like below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"function updateSelection () {\n    Component.Object.Selection = Component.Object.Checkboxes.filter(o => o.Checked)\n    .map(o => Noodl.Object.create({\n            id:Component.Object.id+\"_\"+o.Value,\n            Value:o.Value}\n    ));\n    Script.Outputs.SelectionChanged ();\n}\n\nScript.Setters.Items = function (items) {\n    if(!Script.Inputs.Items) return \n    // Create a lits of all checked items, based on the initial selection array\n    Component.Object.Checkboxes = Script.Inputs.Items.map(o => Noodl.Object.create({\n        id:Component.Object.id+'-'+o.id,\n        Value:o.id,\n        Checked:Script.Inputs.InitialSelection!==undefined && !!Script.Inputs.InitialSelection.find(s => s.Value === o.id)\n    })) \n\n    updateSelection ();\n}\n\nScript.Signals.UpdateSelection = function () {\n    updateSelection ();\n}\n\nScript.Signals.SelectAll = function () {\n    if(!Component.Object.Checkboxes) return \n\n    Component.Object.Checkboxes.forEach ( o => o.Checked = true);\n    updateSelection ();\n}\n\nScript.Signals.DeselectAll = function () {\n    if(!Component.Object.Checkboxes) return\n\n    Component.Object.Checkboxes.forEach ( o => o.Checked = false);\n    updateSelection ();\n}\n")),(0,o.kt)("p",null,"We of course also need to trigger these functions from the ",(0,o.kt)("strong",{parentName:"p"},"Component Inputs")," ports, ",(0,o.kt)("inlineCode",{parentName:"p"},"Select All")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"Clear Selection"),"."),(0,o.kt)("div",{className:"ndl-image-with-background l"},(0,o.kt)("p",null,(0,o.kt)("img",{src:n(69803).Z,width:"1690",height:"842"}))))}h.isMDXComponent=!0},9543:function(e,t,n){t.Z=n.p+"assets/images/component-1-f211b6270c42886eb2b3122303171b9c.png"},68150:function(e,t,n){t.Z=n.p+"assets/images/component-2-01590a4f630ae2b9eb93b37096b3593a.png"},96126:function(e,t,n){t.Z=n.p+"assets/images/component-inputs-1-00260bc124403c654d1f997f0ba0dc49.png"},72523:function(e,t,n){t.Z=n.p+"assets/images/component-outputs-1-fc7428831662937b2053964f3bb03be7.png"},2983:function(e,t,n){t.Z=n.p+"assets/images/listitem-1-17d73147906609b9f7a33e9d2f86dd8b.png"},91458:function(e,t,n){t.Z=n.p+"assets/images/listitem-2-d378dc341c229d4d56936303eeeaea64.png"},231:function(e,t,n){t.Z=n.p+"assets/images/multiselect-list-1-769bddd8dcef92b44a50d38afc30c421.png"},49494:function(e,t,n){t.Z=n.p+"assets/images/multiselect-list-2-36b3218a550752fd57d8a5f4e1bb1cb4.png"},50541:function(e,t,n){t.Z=n.p+"assets/images/multiselect-list-3-1e29a11884bf61f6d557e3f2de4b9c28.png"},39494:function(e,t,n){t.Z=n.p+"assets/images/multiselect-list-4-76079ef1ce3e4e494f022d0c02a63cff.png"},14470:function(e,t,n){t.Z=n.p+"assets/images/multiselect-list-6-65ae508e04b880302dbe6b9ea5388b49.png"},14612:function(e,t,n){t.Z=n.p+"assets/images/multiselect-list-7-aeb26f3efefae3e8d8e89fbcf94efa79.png"},69803:function(e,t,n){t.Z=n.p+"assets/images/multiselect-list-8-17c833987feb86447fd059e43d59ba2b.png"},26399:function(e,t,n){t.Z=n.p+"assets/images/multiselect-script-1-359b38695020e57f16b709db40ef4e80.png"},79374:function(e,t,n){t.Z=n.p+"assets/images/script-1-48148c8218ebfdc41319f799e4bb6970.png"},86393:function(e,t,n){t.Z=n.p+"assets/images/script-2-06c5cef88ca7c6cdd63b32e31f46f469.png"}}]);