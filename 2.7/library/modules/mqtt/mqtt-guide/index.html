<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-library docs-doc-id-modules/mqtt/mqtt-guide">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="search" type="application/opensearchdescription+xml" title="Noodl" href="/2.7/opensearch.xml">
<link rel="alternate" type="application/json" href="/2.7/whats-new/feed.json" title="Noodl JSON Feed">
<!-- Google Tag Manager -->
    <script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-P4LSJL4",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
    <!-- End Google Tag Manager --><title data-rh="true">MQTT Guide | Noodl</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.noodl.net/2.7/library/modules/mqtt/mqtt-guide"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:image" content="https://docs.noodl.net/noodl-docs.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-library-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-library-current"><meta data-rh="true" property="og:title" content="MQTT Guide | Noodl"><meta data-rh="true" name="description" content="In this guide we will create a small MQTT communication example using the Send Message and Receive Message nodes available in the MQTT module."><meta data-rh="true" property="og:description" content="In this guide we will create a small MQTT communication example using the Send Message and Receive Message nodes available in the MQTT module."><link data-rh="true" rel="icon" href="/2.7/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.noodl.net/2.7/library/modules/mqtt/mqtt-guide"><link data-rh="true" rel="alternate" href="https://docs.noodl.net/2.7/library/modules/mqtt/mqtt-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.noodl.net/2.7/library/modules/mqtt/mqtt-guide" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://D29X2LNM4J-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/2.7/assets/css/styles.eeff0abb.css">
<link rel="preload" href="/2.7/assets/js/runtime~main.0c7a5c97.js" as="script">
<link rel="preload" href="/2.7/assets/js/main.6908215e.js" as="script">

<link rel="canonical" href="https://docs.noodl.net/2.9/" />
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/2.7/"><div class="navbar__logo"><img src="/2.7/img/logo.svg" alt="Noodl Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/2.7/img/logo.svg" alt="Noodl Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Docs</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/2.7/docs/learn">Learn</a><a class="navbar__item navbar__link" href="/2.7/nodes/overview">Node reference</a><a class="navbar__item navbar__link" href="/2.7/library/overview">Library</a><a class="navbar__item navbar__link has-divider" href="/2.7/javascript/overview">Javascript</a><a href="https://forum.noodl.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Forum</a><a href="https://discord.com/invite/23xU2hYrSJ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link is-discord">Discord</a><a href="https://console.noodl.net/#/signup" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link is-download-button">Download</a><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><div class="search-bar-outer"><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/2.7/library/modules/mqtt/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret menu__link--active">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/2.7/library/modules/mqtt/mqtt-guide">Basics</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist-caret">Nodes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2.7/library/modules/mqtt/send-message">Send Message</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/2.7/library/modules/mqtt/receive-message">Receive Message</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/2.7/library/modules/overview">Back to modules</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="Root_noPZ"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>MQTT </h1><p>In this guide we will create a small MQTT communication example using the <em>Send Message</em> and <em>Receive Message</em> nodes available in the MQTT module.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>MQTT is a very popular communication protocol between IoT devices. It&#x27;s based on a simple publisher/subscriber architecture where all messages pass through an MQTT broker, who directs messages from publishers to subscribers. As a subscriber, you subscribe to <em>topics</em>, which are typically made up of different subpaths. As a publisher of messages, you publish your messages to these topics. A message can contain a <em>payload</em>, i.e. a data object with one or more pieces of data.</p><p>As an example, an IoT thermometer, called &quot;thermometer1&quot;, may publish temperature and pressure data to &quot;/thermometer1/thermometer&quot; topic with a payload containing a time, a temperature and a pressure reading.</p><p>MQTT is a very capable protocol and we will only cover parts of it in this guide. You can read more about it <a href="https://en.wikipedia.org/wiki/MQTT" target="_blank" rel="noopener noreferrer">here</a>;</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="using-the-the-mqtt-module">Using the the MQTT module<a class="hash-link" href="#using-the-the-mqtt-module" title="Direct link to heading">​</a></h2><p>First, let&#x27;s create a new project using the minimal &quot;Hello&quot; template. Give the project a name, for example &quot;MQTT Messaging&quot;.
Since the MQTT nodes are not part of the default node set in Noodl, we need to enable the MQTT module. Find the module tab in the sidebar and add the &quot;MQTT&quot; module.</p><p>Now two more nodes are available in your project, the <a href="/2.7/library/modules/mqtt/send-message"><strong>Send Message</strong></a> and <a href="/2.7/library/modules/mqtt/receive-message"><strong>Receive Message</strong></a> nodes.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide1-66de59b1f43d73220ef18d9b1657f74e.png" width="628" height="882" class="img_E7b_"></p><p>Try adding a <strong>Send Message</strong> and <strong>Receive Message</strong> node to the project, to see that they are now available.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="connecting-to-an-mqtt-broker">Connecting to an MQTT broker<a class="hash-link" href="#connecting-to-an-mqtt-broker" title="Direct link to heading">​</a></h2><p>For the MQTT messaging to work, we need to connect to an MQTT broker. Setting up and hosting a commercial, secure MQTT broker is a bit of a hassle. So for this guide we will instead use the open MQTT broker &quot;Shiftr&quot;. It&#x27;s being hosted in the cloud so we don&#x27;t need to worry about hosting it. Another good alternative is the open source broker <a href="https://mosquitto.org/" target="_blank" rel="noopener noreferrer">Mosquitto</a> that you can run locally or host yourself.</p><p>Go to <a href="http://shiftr.io" target="_blank" rel="noopener noreferrer">shiftr.io</a> and sign up for an account if you don&#x27;t already have one. Also create a new &quot;Name space&quot; and a &quot;Token&quot; for the namespace. In the end you should have created an MQTT endpoint to use, similar to the one below.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide2-cc554b553e4ff504cfdbef72b253c850.png" width="723" height="170" class="img_E7b_"></p><p>Now go into your project settings and paste in the URL (beginning with &quot;mqtt:&quot;) into the &quot;Broker URL&quot; field.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide3-d065919f874fbfa32aade3eaa593007c.png" width="490" height="386" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="testing-our-mqtt-broker">Testing our MQTT broker<a class="hash-link" href="#testing-our-mqtt-broker" title="Direct link to heading">​</a></h2><p>Ok, now we have everything to get started to send MQTT messages. Let&#x27;s try it!</p><p>Start by adding a &quot;Send Message&quot; node. Set its topic to &quot;mytopic&quot; and add a payload called &quot;myvalue&quot;.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide4-b00518b7cdc9ef4e5a976314da229586.png" width="1034" height="940" class="img_E7b_"></p><p>Now let&#x27;s send our first message to the topic &quot;mytopic&quot;. So we assign a value to the input &quot;myvalue&quot;, using a <strong>Number</strong> node and connect the <em>Send</em> signal to the click event of the background <strong>Group</strong>. Any value is fine, we just want to see if it&#x27;s working.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide5-7686c50ab9444e76d3463f62e724f0bf.png" width="930" height="666" class="img_E7b_"></p><p>When you start clicking the background rectangle, you should now be sending messages to the MQTT broker. If you bring up you web browser with your Shiftr name space topology you should be seeing some events entering the system everytime you click. Again, remember that the MQTT messages are being sent to a router hosted somewhere in the cloud, which means that any device with an internet connection can now connect to your Noodl app, or vice versa, by sending messages to the router.</p><div class="ndl-images"><img loading="lazy" src="/2.7/library/modules/mqtt/mqtt-guide-img/mqtt-guide6.gif" class="ndl-image medium img_E7b_"><button class="ndl-copy-nodes-button"></button></div><p>You can inspect the messages in Shiftr and see the payload that&#x27;s being sent. Also try opening a few browser windows running your simple Noodl app. As you can see, there are now multiple clients in Shiftr that can publish messages to the &quot;mytopic&quot; topic. Each browser window is a publisher in the broker, as well as your Noodl Editor.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide7-38bff9b6445643b3cd01b1933e80559e.png" width="1078" height="788" class="img_E7b_"></p><p>Now let&#x27;s change things up slightly as we are going to receive messages as well. We are going to assign each client a random color. When you click the background, that color will be sent out to all subscribers of the topic &quot;mytopic&quot;. A circle in the middle of the screen will present any received value.</p><p>The random color is generated using a <strong>Color Blend</strong> node with 5 different base colors. By generating a random number, between 0 and 5, we randomly pick a color on that color scale. Each client will have their own random number and respective color.</p><p>The color is published once the background is clicked, or rather, the random number is published. When you receive a message which will include the random number, that number is translated back to a color through a <strong>Color Blend</strong> node with the same colors as before.</p><div class="ndl-images"><img loading="lazy" src="/2.6/library/modules/mqtt/mqtt-guide-img/mqtt-guide8.png" class="ndl-image medium img_E7b_"><button class="ndl-copy-nodes-button"></button></div><p>Let&#x27;s load a couple of browser windows running your app, and maybe your mobile phone as well, and click around in the different windows. If everything works as expected you should see that the inner circles in all clients will change color to the background you just clicked.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide9-a0d16596f5aee823410b6dce1e818f26.gif" width="640" height="393" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="dynamic-topic-names">Dynamic Topic names<a class="hash-link" href="#dynamic-topic-names" title="Direct link to heading">​</a></h2><p>We have now published and subscribed to messages on one single topic, basically broadcasting messages to all clients. You may want to identify yourself as a publisher, or be more selective on what messages you subscribe to. So let&#x27;s divide the clients into five groups. You belong to a specific group (Group_1 - Group_5) depending on a random number (0-0.999... belong to first group, 1-1.999... to second, etc). We use some neat nodes, i.e. <a href="/2.7/nodes/math/expression"><strong>Expressions</strong></a> and <a href="/2.7/nodes/string-manipulation/string-format"><strong>String Formats</strong></a> to create the group names and determine which group you belong to.</p><p>Each group gets its own topic which is dynamically created using a <em>{}</em> construct. Note that you have to be a bit careful when naming topics. For example, avoid whitespaces, hence we call the groups &quot;Group_X&quot;.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide10-b0e40412099aa3011f5622cc0d6e73f4.png" width="1408" height="684" class="img_E7b_"></p><p>There is also a <strong>Receive Message</strong> node that each group uses to subscribe to only its group messages. When they receive a message a <strong>Transiton</strong> node triggers an animation of the opacity of the <strong>Text</strong> node, causing it to flash in the circle.</p><p>{&#x27; &#x27;}</p><div class="ndl-images"><img loading="lazy" src="/2.7/library/modules/mqtt/mqtt-guide-img/mqtt-guide11.png" class="ndl-image large img_E7b_"><button class="ndl-copy-nodes-button"></button></div><p>You can see that the new topics start popping up in the Shiftr topology once you start sending messages between the browser windows.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide12-0316d17463bf3d25ae0803cbc773224e.png" width="1142" height="664" class="img_E7b_"></p><p>As you click around you in your browser windows you can see that messages are only sent within a group.</p><p><img loading="lazy" src="/2.7/assets/images/mqtt-guide13-cfd0411e8443542177a6a03695a9d056.gif" width="640" height="393" class="img_E7b_"></p><p>Now you know how to publish and subscribe to topics and how to connect to an MQTT broker. This can for example be used to connect to an Arduino or a Raspberry Pi, etc, if you want to play with some hardware. Find some software that can connect to an MQTT broker and start publishing and subscribing to messages. Best of luck!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/2.7/library/modules/mqtt/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">MQTT Module</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/2.7/library/modules/mqtt/send-message"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Send Message</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#using-the-the-mqtt-module" class="table-of-contents__link toc-highlight">Using the the MQTT module</a></li><li><a href="#connecting-to-an-mqtt-broker" class="table-of-contents__link toc-highlight">Connecting to an MQTT broker</a></li><li><a href="#testing-our-mqtt-broker" class="table-of-contents__link toc-highlight">Testing our MQTT broker</a></li><li><a href="#dynamic-topic-names" class="table-of-contents__link toc-highlight">Dynamic Topic names</a></li></ul></div></div></div></div></div></main></div></div></div>
<script src="/2.7/assets/js/runtime~main.0c7a5c97.js"></script>
<script src="/2.7/assets/js/main.6908215e.js"></script>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P4LSJL4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --></body>
</html>
